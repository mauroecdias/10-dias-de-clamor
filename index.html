<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jornada de Oração</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .form-container { max-width: 400px; width: 100%; }
        input { width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ccc; border-radius: 5px; }
        button { width: 100%; padding: 15px; background: #2ecc71; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        
        /* Área da Imagem (Escondida ou fora da tela) */
        #canvas-export {
            width: 1080px;
            height: 1920px;
            position: absolute;
            left: -9999px; /* Mantém fora da visão do usuário */
            background-image: url('https://different-coffee-gch4prkg90.edgeone.app/fundo.jpg');
            background-size: cover;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: white; /* Ajuste conforme a cor do seu fundo */
            text-align: center;
        }
        .logo { width: 400px; margin-top: 150px; }
        .names-list { margin-top: 200px; font-size: 50px; line-height: 1.8; }
        .user-name { margin-top: 100px; font-size: 40px; font-style: italic; }
    </style>
</head>
<body>

    <div class="form-container">
        <h2>Minha Jornada de Oração</h2>
        <input type="text" id="meuNome" placeholder="Seu Nome">
        <hr>
        <p>Vou orar por:</p>
        <input type="text" class="nomeOracao" placeholder="Nome 1">
        <input type="text" class="nomeOracao" placeholder="Nome 2">
        <input type="text" class="nomeOracao" placeholder="Nome 3">
        <input type="text" class="nomeOracao" placeholder="Nome 4">
        <input type="text" class="nomeOracao" placeholder="Nome 5">
        <br><br>
        <button onclick="processar()">SALVAR E BAIXAR</button>
    </div>

    <div id="canvas-export">
        <img src="https://inherent-copper-64qkrrgzuy.edgeone.app/logo.png" class="logo">
        <div class="names-list" id="display-nomes"></div>
        <div class="user-name" id="display-meu-nome"></div>
    </div>

    <script>
        async function processar() {
            const meuNome = document.getElementById('meuNome').value;
            const nomesOracao = Array.from(document.querySelectorAll('.nomeOracao')).map(i => i.value);

            // 1. Atualizar visual da imagem
            document.getElementById('display-meu-nome').innerText = "Orado por: " + meuNome;
            document.getElementById('display-nomes').innerHTML = nomesOracao.join('<br>');

            // 2. Gerar e baixar a imagem
            const canvasArea = document.getElementById('canvas-export');
            const canvas = await html2canvas(canvasArea, { useCORS: true });
            const link = document.createElement('a');
            link.download = 'minha-jornada-oracao.png';
            link.href = canvas.toDataURL();
            link.click();

            // 3. Enviar para o Google Sheets
            // Substitua pela URL do seu Web App do Google Scripts
            const urlSheets = "https://script.google.com/macros/s/AKfycbw688WwTnMWUoz7mOOpL4y3YEu3s7x8oFJQlzk0bcE63Ec5Yn6LsKuNK6KIR_Mf4FX49g/exec";
            fetch(urlSheets, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ meuNome, nomesOracao })
            });
            
            alert("Salvo com sucesso!");
        }
    </script>
</body>
</html>